<nav>
  <a class="nav-toggle" id="open-nav" href="#">&#9776;</a>
  <a class="editor-link btn" href="cloudcannon:collections/_data/navigation.yml" class="btn"><strong>&#9998;</strong> Edit navigation</a>

  {%- assign links=site.data.navigation -%}
  {%- for link in links -%}
    {%- assign class = "" -%}
    {%- if link.highlight -%}
      {%- assign class = class | append: " highlight" -%}
    {%- endif -%}

    {%- if link.link == page.url -%}
      {%- assign class = class | append: " active" -%}
    {%- endif -%}

      <a href="{{ link.link }}" class="{{ class }}" {% if link.new_window %}target="_blank"{% endif %}>{{ link.name }}</a>
  {% endfor %}

  {% assign switch_lang=site.data.other_lang[site.active_lang] %}
  {%- if switch_lang -%}
  <!--  N.B. The space at the start href is intentional -->
  <!--  It's how polyglot knows not to relativise the link -->
  <a href=" {{ site.baseurl }}/{{ switch_lang }}{{ page.url }}" class="{{ apost.lang }}">
    {{ site.data.languages[switch_lang] }}
  </a>
  {%- endif -%}

</nav>

<ul>
{% for item in site.menus.header %}
  <li class="menu-item-{{ loop.index }}">
    <a href="{{ item.url }}" title="Go to {{ item.title }}">{{ item.title }}</a>
    {% if item.children %}
      <ul class="sub-menu">
      {% for item in item.children %}
        <li class="menu-item-{{ loop.index }}">
          <a href="{{ item.url }}" title="Go to {{ item.title }}">{{ item.title }}</a>
        </li>
      {% endfor %}
      </ul>
    {% endif %}
  </li>
{% endfor %}
</ul>
<hr>
<h4>
  Menu hierarchy seems right on the menu object (below),
  but the children property is empty when looping through the items (above).
  <br>
  While researching, I found forestryio/jekyll-menus#14 and it seems to be what's happening here.
</h4>
{{ site.menus.header.menu }}
